=> JUSTE APRES UN REBOOT DU PC et BRANCHEMENT du MODEM
=> ne pas entrer code PIN demandÃ© a priori par ModemManager

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 --query-signal-state
[/dev/cdc-wdm2] Signal state:
	          RSSI [0-31,99]: '99'
	     Error rate [0-7,99]: '99'
	Signal strength interval: '5'
	          RSSI threshold: '2'
	    Error rate threshold: 'unspecified'

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-radio-state 
[/dev/cdc-wdm2] Radio state retrieved:
	     Hardware radio state: 'on'
	     Software radio state: 'on'

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 --query-pin-state
error: operation failed: Transaction timed out

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 --query-pin-state
[/dev/cdc-wdm2] PIN info:
	         PIN state: 'locked'
	          PIN type: 'pin1'
	Remaining attempts: '3'

=> OPTION -p permet d'aller plus vite (TODO : pourquoi)

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-device-caps 
[/dev/cdc-wdm2] Device capabilities retrieved:
	      Device type: 'remote'
	   Cellular class: 'gsm'
	      Voice class: 'no-voice'
	        SIM class: 'removable'
	       Data class: 'umts, hsdpa, hsupa, lte'
	         SMS caps: 'pdu-receive, pdu-send'
	        Ctrl caps: 'reg-manual'
	     Max sessions: '8'
	Custom data class: 'unknown'
	        Device ID: '354479085366977'
	    Firmware info: 'SWI9X30C_02.24.05.06'
	    Hardware info: 'EM7455B'

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-device-services 
[/dev/cdc-wdm2] Device services retrieved:
	Max DSS sessions: '0'
	        Services: (13)

		          Service: 'basic-connect'
		             UUID: [a289cc33-bcbb-8b4f-b6b0-133ec2aae6df]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: device-caps (1),
		                   subscriber-ready-status (2),
		                   radio-state (3),
		                   pin (4),
		                   pin-list (5),
		                   home-provider (6),
		                   preferred-providers (7),
		                   visible-providers (8),
		                   register-state (9),
		                   packet-service (10),
		                   signal-state (11),
		                   connect (12),
		                   provisioned-contexts (13),
		                   ip-configuration (15),
		                   device-services (16),
		                   device-service-subscribe-list (19),
		                   packet-statistics (20),
		                   network-idle-hint (21),
		                   emergency-mode (22),
		                   ip-packet-filters (23)

		          Service: 'sms'
		             UUID: [533fbeeb-14fe-4467-9f90-33a223e56c3f]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: configuration (1),
		                   read (2),
		                   send (3),
		                   delete (4),
		                   message-store-status (5)

		          Service: 'ussd'
		             UUID: [e550a0c8-5e82-479e-82f7-10abf4c3351f]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: ussd (1)

		          Service: 'phonebook'
		             UUID: [4bf38476-1e6a-41db-b1d8-bed289c25bdb]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: configuration (1),
		                   read (2),
		                   delete (3),
		                   write (4)

		          Service: 'stk'
		             UUID: [d8f20131-fcb5-4e17-8602-d6ed3816164c]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: pac (1),
		                   terminal-response (2),
		                   envelope (3)

		          Service: 'auth'
		             UUID: [1d2b5ff7-0aa1-48b2-aa52-50f15767174e]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: aka (1),
		                   sim (3)

		          Service: 'qmi'
		             UUID: [d1a30bc2-f97a-6e43-bf65-c7e24fb0f0d3]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: msg (1)

		          Service: 'unknown'
		             UUID: [8b569648-628d-4653-9b9f-1025404424e1]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: 1, 2, 3

		          Service: 'ms-host-shutdown'
		             UUID: [883b7c26-985f-43fa-9804-27d7fb80959c]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: notify (1)

		          Service: 'unknown'
		             UUID: [2d0c12c9-0e6a-495a-915c-8d174fe5d63c]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: 1, 2

		          Service: 'ms-firmware-id'
		             UUID: [e9f7dea2-feaf-4009-93ce-90a3694103b6]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: get (1)

		          Service: 'atds'
		             UUID: [5967bdcc-7fd2-49a2-9f5c-b2e70e527db3]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: signal (1),
		                   location (2),
		                   operators (3),
		                   rat (4),
		                   register-state (9),
		                   unknown (10)

		          Service: 'unknown'
		             UUID: [6427015f-579d-48f5-8c54-f43ed1e76f83]:
		      DSS payload: 0
		Max DSS instances: 0
		             CIDs: 1, 2, 3

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-visible-providers 
error: operation failed: NotInitialized

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-visible-providers 
error: operation failed: NotInitialized
stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 --en
--enable-pin=  --enter-pin=   --enter-puk=   
stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 --en
--enable-pin=  --enter-pin=   --enter-puk=   
stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --enter-pin=7320
[/dev/cdc-wdm2] PIN operation successful

[/dev/cdc-wdm2] PIN info:
	         PIN state: 'locked'
	          PIN type: 'pin2'
	Remaining attempts: '3'
stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-visible-providers 
[/dev/cdc-wdm2] Visible providers (4):
	Provider [0]:
		    Provider ID: '20810'
		  Provider name: 'F SFR'
		          State: 'home, preferred, visible'
		 Cellular class: 'gsm'
		           RSSI: '99'
		     Error rate: '99'
	Provider [1]:
		    Provider ID: '20815'
		  Provider name: 'Free'
		          State: 'forbidden, visible'
		 Cellular class: 'gsm'
		           RSSI: '99'
		     Error rate: '99'
	Provider [2]:
		    Provider ID: '20801'
		  Provider name: 'Orange F'
		          State: 'forbidden, visible'
		 Cellular class: 'gsm'
		           RSSI: '99'
		     Error rate: '99'
	Provider [3]:
		    Provider ID: '20820'
		  Provider name: 'F-Bouygues Telecom'
		          State: 'forbidden, visible'
		 Cellular class: 'gsm'
		           RSSI: '99'
		     Error rate: '99'

=> conclusion
=> certaines requetes necessitent l'entree du code PIN

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-home-provider 
[/dev/cdc-wdm2] Home provider:
	   Provider ID: '20810'
	 Provider name: 'F SFR'
	         State: 'home'
	Cellular class: 'gsm'
	          RSSI: '99'
	    Error rate: '99'

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-registration-state
[/dev/cdc-wdm2] Registration status:
	         Network error: 'unknown'
	        Register state: 'home'
	         Register mode: 'automatic'
	Available data classes: 'umts, hsdpa, hsupa'
	Current cellular class: 'gsm'
	           Provider ID: '20810'
	         Provider name: 'F SFR'
	          Roaming text: 'unknown'
	    Registration flags: 'packet-service-automatic-attach'

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --query-subscriber-ready-status 
[/dev/cdc-wdm2] Subscriber ready status retrieved:
	      Ready state: 'initialized'
	    Subscriber ID: '208101089036411'
	        SIM ICCID: '89331010181574461454'
	       Ready info: 'none'
	Telephone numbers: (3) ''

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --atds-query-location
[/dev/cdc-wdm2] Cell location retrieved:
	       LAC: 6b74
	       TAC: 0000
	   Cell ID: a0a6f9c


stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --atds-query-signal 
[/dev/cdc-wdm2] Signal info retrieved:
	      RSSI: unknown
	       BER: unknown
	      RSCP: -99 dBm
	     Ec/No: -10,00 dBm
	      RSRQ: unknown
	      RSRP: unknown
	     RSSNR: unknown

stef@dell00:~/git/modem4g$ sudo mbimcli --device=/dev/cdc-wdm2 -p --attach-packet-service
[/dev/cdc-wdm2] Successfully attached to packet service

[/dev/cdc-wdm2] Packet service status:
	         Network error: 'unknown'
	  Packet service state: 'attached'
	Available data classes: 'hsdpa, hsupa'
	          Uplink speed: '5742000 bps'
	        Downlink speed: '42200000 bps'


=> on substitue alors les commandes mbim-network start par les commandes mbimcli
=> notamment la derniere commande 

stef@dell00:~/git/modem4g$ sudo mbimcli -d /dev/cdc-wdm2 -p --connect=apn='sl2sfr'
[/dev/cdc-wdm2] Successfully connected

[/dev/cdc-wdm2] Connection status:
	      Session ID: '0'
	Activation state: 'activated'
	Voice call state: 'none'
	         IP type: 'ipv4'
	    Context type: 'internet'
	   Network error: 'pdp-type-ipv4-only-allowed'

[/dev/cdc-wdm2] IPv4 configuration available: 'address, gateway, dns, mtu'
     IP [0]: '100.108.117.133/30'
    Gateway: '100.108.117.134'
    DNS [0]: '172.20.2.39'
    DNS [1]: '172.20.2.10'
        MTU: '1428'

[/dev/cdc-wdm2] IPv6 configuration available: 'none'



